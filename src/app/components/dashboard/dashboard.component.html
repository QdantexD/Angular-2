<div class="dashboard-container" #dashboardContainer>
  <div class="dashboard-header">
    <h1 class="dashboard-title neon-text">Dashboard</h1>
    <div class="period-selector">
      <button
        *ngFor="let period of periods"
        [class.active]="selectedPeriod === period"
        (click)="onPeriodChange(period)"
        class="period-btn"
      >
        {{ getPeriodLabel(period) }}
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <div *ngIf="!loading && dashboardData" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card glass">
        <div class="stat-icon" style="color: #00f0ff;">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect x="4" y="8" width="24" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
            <path d="M4 12 L16 18 L28 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-label">Total Juegos</h3>
          <p class="stat-value">{{ dashboardData.stats.totalGames }}</p>
        </div>
      </div>

      <div class="stat-card glass">
        <div class="stat-icon" style="color: #b026ff;">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <circle cx="16" cy="12" r="4" stroke="currentColor" stroke-width="2"/>
            <path d="M8 26 C8 20 11 18 16 18 C21 18 24 20 24 26" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-label">Total Usuarios</h3>
          <p class="stat-value">{{ dashboardData.stats.totalUsers }}</p>
        </div>
      </div>

      <div class="stat-card glass">
        <div class="stat-icon" style="color: #00ff88;">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <path d="M6 16 L14 24 L26 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-label">Ingresos Totales</h3>
          <p class="stat-value">S/ {{ formatRevenue(dashboardData.stats.totalRevenue) }}</p>
        </div>
      </div>

      <div class="stat-card glass">
        <div class="stat-icon" style="color: #ff00ff;">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect x="6" y="6" width="20" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
            <path d="M12 16 L16 12 L20 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-label">Juegos Gratis</h3>
          <p class="stat-value">{{ dashboardData.stats.freeGames }}</p>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <div class="chart-card glass">
        <h2 class="chart-title">Juegos por Categor√≠a</h2>
        <div class="chart-container">
          <div *ngFor="let category of dashboardData.categories" class="category-item">
            <div class="category-bar">
              <div
                class="category-fill"
                [style.width]="getCategoryWidth(category.count) + '%'"
                [style.background]="getCategoryColor(category.category)"
              ></div>
            </div>
            <div class="category-info">
              <span class="category-name">{{ category.category }}</span>
              <span class="category-count">{{ category.count }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-card glass">
        <h2 class="chart-title">Juegos Recientes</h2>
        <div class="recent-games">
          <div *ngFor="let game of dashboardData.recentGames" class="recent-game-item">
            <div class="game-image" [style.background-image]="getGameImageUrl(game.image_url)"></div>
            <div class="game-info">
              <h4>{{ game.title }}</h4>
              <p class="game-category">{{ game.category }}</p>
            </div>
            <div class="game-badge" [style.color]="game.color">
              {{ getBadge(game) }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Analytics Charts -->
    <div *ngIf="analyticsData" class="analytics-section">
      <div class="chart-card glass">
        <h2 class="chart-title">Juegos Creados en el Tiempo</h2>
        <div class="line-chart">
          <div *ngFor="let data of analyticsData.gamesOverTime" class="chart-point">
            <div class="point-value">{{ data.count }}</div>
            <div class="point-bar" [style.height]="getBarHeight(data.count) + '%'"></div>
            <div class="point-label">{{ formatDate(data.date) }}</div>
          </div>
        </div>
      </div>

      <div class="chart-card glass">
        <h2 class="chart-title">Top 10 Juegos</h2>
        <div class="top-games-list">
          <div *ngFor="let game of analyticsData.topGames; let i = index" class="top-game-item">
            <span class="game-rank">#{{ i + 1 }}</span>
            <div class="game-details">
              <h4>{{ game.title }}</h4>
              <div class="game-metrics">
                <span>Descargas: {{ getGameDownloads(game) }}</span>
                <span>Rating: {{ getGameRating(game) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
